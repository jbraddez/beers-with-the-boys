<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Down It - Beers With The Boys</title>
    <link rel="website icon" href="/images/logo.png">
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/styles/dontmove.css">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Beers With The Boys">
    <meta name="description" content="Home to numerous activites, let Beers With The Boys decide your drinks, play some games, and get you drunk while having fun.">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
    <link rel="mask-icon" href="/images/logo.png" color="#000000">
    <link rel="manifest" href="/manifest.json"> 
</head>
<body>
    <header>
        <a class="back" href="/"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg></a>
        <a href="/dontmove.html"><img src="/images/dontmove.png" alt="Don't Move"></a>
        <select name="difficulty" id="difficulty">
            <option selected value="3">Easy</option>
            <option value="1.8">Medium</option>
            <option value="0.9">Hard</option>
            <option value="0.4">Impossible</option>
        </select>
    </header>
   
   
  <main>
    <h1>Don't Move</h1>
    <button id="startBtn">Start Game</button>
    <div id="status">Press Start to Begin</div>

    <h2 id="timer"></h2>
  </main>

  <script>
    let motionActive = false;
    var threshold = 3; 
    const status = document.getElementById('status');
    const timerDisplay = document.getElementById('timer');
  
    let timerInterval;
    let startTime;
  
    document.getElementById('startBtn').addEventListener('click', async () => {
      if (typeof DeviceMotionEvent.requestPermission === 'function') {
        try {
          const response = await DeviceMotionEvent.requestPermission();
          if (response !== 'granted') throw 'Permission denied';
        } catch (err) {
          status.innerHTML = 'Motion access denied';
          return;
        }
      }
  
      status.innerHTML = 'Game started. Donâ€™t move...';
      timerDisplay.textContent = "0.0s";
      motionActive = true;
  
      startTime = Date.now();
      timerInterval = setInterval(() => {
        const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
        timerDisplay.textContent = `${elapsed}s`;
      }, 100);
  
      window.addEventListener('devicemotion', detectMovement);
    });
  
    function detectMovement(event) {
      if (!motionActive) return;
  
      const acc = event.acceleration;
      const totalAcc = Math.abs(acc.x || 0) + Math.abs(acc.y || 0) + Math.abs(acc.z || 0);
  
      if (totalAcc > threshold) {
        motionActive = false;
        clearInterval(timerInterval);
        window.removeEventListener('devicemotion', detectMovement);
  
        const finalTime = ((Date.now() - startTime) / 1000).toFixed(1);
        status.innerHTML = `You moved after <span class="warning">${finalTime}s</span>!`;
      }
    }

    document.getElementById("difficulty").addEventListener("change", function() {
        threshold = parseFloat(this.value);
    });
  </script>
  

</body>
</html>
